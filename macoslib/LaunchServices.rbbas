#tag ModuleProtected Module LaunchServices	#tag Method, Flags = &h0		Function FindAppForItem(item as FolderItem, roles as Uint32 = &hFFFFFFFF) As FolderItem		  #if targetMacOS		    soft declare function LSGetApplicationForItem lib CarbonFramework (ByRef inItemRef as FSRef, inRolesMask as UInt32, ByRef outAppRef as FSRef, outAppURL as Ptr) as Integer		    		    dim itemRef as FSRef = FileManager.GetFSRefFromFolderItem(item)		    if not  FileManager.IsValid(itemRef) then		      return nil		    end if		    		    dim appRef as FSRef		    		    dim OSError as Integer = LSGetApplicationForItem(itemRef, roles, appRef, nil)		    if OSError = noErr then		      return FileManager.GetFolderItemFromFSRef(appRef)		    else		      return nil		    end if		  #endif		End Function	#tag EndMethod	#tag Constant, Name = kLSRolesNone, Type = Double, Dynamic = False, Default = \"&h00000001", Scope = Public	#tag EndConstant	#tag Constant, Name = kLSRolesViewer, Type = Double, Dynamic = False, Default = \"&h00000002", Scope = Public	#tag EndConstant	#tag Constant, Name = kLSRolesEditor, Type = Double, Dynamic = False, Default = \"&h00000004", Scope = Public	#tag EndConstant	#tag Constant, Name = kLSRolesShell, Type = Double, Dynamic = False, Default = \"&h00000008", Scope = Public	#tag EndConstant	#tag Constant, Name = kLSRolesAll, Type = Double, Dynamic = False, Default = \"&hffffffff", Scope = Public	#tag EndConstant	#tag Constant, Name = kLSLaunchDefaults, Type = Double, Dynamic = False, Default = \"&h00000001", Scope = Public	#tag EndConstant	#tag Constant, Name = kLSLaunchAndPrint, Type = Double, Dynamic = False, Default = \"&h00000002", Scope = Public	#tag EndConstant	#tag Constant, Name = Untitled, Type = , Dynamic = False, Default = \"", Scope = Public	#tag EndConstant	#tag Constant, Name = kLSLaunchReserved2, Type = Double, Dynamic = False, Default = \"&h00000004", Scope = Public	#tag EndConstant	#tag Constant, Name = kLSLaunchReserved3, Type = Double, Dynamic = False, Default = \"&h00000008", Scope = Public	#tag EndConstant	#tag Constant, Name = kLSLaunchReserved4, Type = Double, Dynamic = False, Default = \"&h00000010", Scope = Public	#tag EndConstant	#tag Constant, Name = kLSLaunchReserved5, Type = Double, Dynamic = False, Default = \"&h00000020", Scope = Public	#tag EndConstant	#tag Constant, Name = kLSLaunchAndDisplayErrors, Type = Double, Dynamic = False, Default = \"&h00000040", Scope = Public	#tag EndConstant	#tag Constant, Name = kLSLaunchInhibitBGOnly, Type = Double, Dynamic = False, Default = \"&h00000080", Scope = Public	#tag EndConstant	#tag Constant, Name = kLSLaunchDontAddToRecents, Type = Double, Dynamic = False, Default = \"&h00000100", Scope = Public	#tag EndConstant	#tag Constant, Name = kLSLaunchDontSwitch, Type = Double, Dynamic = False, Default = \"&h00000200", Scope = Public	#tag EndConstant	#tag Constant, Name = kLSLaunchNoParams, Type = Double, Dynamic = False, Default = \"&h00000800", Scope = Public	#tag EndConstant	#tag Constant, Name = kLSLaunchAsync, Type = Double, Dynamic = False, Default = \"&h00010000", Scope = Public	#tag EndConstant	#tag Constant, Name = kLSLaunchStartClassic, Type = Double, Dynamic = False, Default = \"&h00020000", Scope = Public	#tag EndConstant	#tag Constant, Name = kLSLaunchInClassic, Type = Double, Dynamic = False, Default = \"&h00040000", Scope = Public	#tag EndConstant	#tag Constant, Name = kLSLaunchNewInstance, Type = Double, Dynamic = False, Default = \"&h00080000", Scope = Public	#tag EndConstant	#tag Constant, Name = kLSLaunchAndHide, Type = Double, Dynamic = False, Default = \"&h00100000", Scope = Public	#tag EndConstant	#tag Constant, Name = kLSLaunchAndHideOthers, Type = Double, Dynamic = False, Default = \"&h00200000", Scope = Public	#tag EndConstant	#tag Constant, Name = kLSLaunchHasUntrustedContents, Type = Double, Dynamic = False, Default = \"&h00400000", Scope = Public	#tag EndConstant	#tag Constant, Name = kLSRequestExtension, Type = Double, Dynamic = False, Default = \"&h00000001", Scope = Public	#tag EndConstant	#tag Constant, Name = kLSRequestTypeCreator, Type = Double, Dynamic = False, Default = \"&h00000002", Scope = Public	#tag EndConstant	#tag Constant, Name = kLSRequestBasicFlagsOnly, Type = Double, Dynamic = False, Default = \"&h00000004", Scope = Public	#tag EndConstant	#tag Constant, Name = kLSRequestAppTypeFlags, Type = Double, Dynamic = False, Default = \"&h00000008", Scope = Public	#tag EndConstant	#tag Constant, Name = kLSRequestAllFlags, Type = Double, Dynamic = False, Default = \"&h00000010", Scope = Public	#tag EndConstant	#tag Constant, Name = kLSRequestIconAndKind, Type = Double, Dynamic = False, Default = \"&h00000020", Scope = Public	#tag EndConstant	#tag Constant, Name = kLSRequestExtensionFlagsOnly, Type = Double, Dynamic = False, Default = \"&h00000040", Scope = Public	#tag EndConstant	#tag Constant, Name = kLSRequestAllInfo, Type = Double, Dynamic = False, Default = \"&hFFFFFFFF", Scope = Public	#tag EndConstant	#tag Structure, Name = LSApplicationParameters, Flags = &h0		version as Int32		  flags as UInt32		  application as Ptr		  asyncLaunchRefCon as Ptr		  environment as Ptr		  argv as Ptr		initialEvent as Ptr	#tag EndStructure	#tag Structure, Name = LSLaunchFSRefSpec, Flags = &h0		appRef as Ptr		  numDocs as UInt32		  itemRefs as Ptr		  passThruParams as Ptr		  launchFlags as Uint32		asyncRefCon as Ptr	#tag EndStructure	#tag Structure, Name = LSLaunchURLSpec, Flags = &h0		appURL as Ptr		  itemURLs as Ptr		  passThruParams as Ptr		  launchFlags as UInt32		asyncRefCon as Ptr	#tag EndStructure	#tag Structure, Name = LSItemInfoRecord, Flags = &h0		flags as Ptr		  filetype as OSType		  creator as OSType		  extension as Ptr		  iconFileName as Ptr		kindID as UInt32	#tag EndStructure	#tag ViewBehavior		#tag ViewProperty			Name="Name"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Index"			Visible=true			Group="ID"			InitialValue="-2147483648"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Super"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Left"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Top"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty	#tag EndViewBehaviorEnd Module#tag EndModule