#tag ClassProtected Class UTI	#tag Method, Flags = &h0		 Shared Function AreEqual(uti1 as CFStringRef, uti2 as CFStringRef) As Boolean		  #if targetMacOS		    soft declare function UTTypeEqual lib CarbonFramework (uti1 as CFStringRef, uti2 as CFStringRef) as Boolean		    		    return UTTypeEqual(uti1, uti2)		  #endif		End Function	#tag EndMethod	#tag Method, Flags = &h0		 Shared Function Description(uti as CFStringRef) As String		  #if targetMacOS		    soft declare function UTTypeCopyDescription lib CarbonFramework (uti as CFStringRef) as CFStringRef		    		    return UTTypeCopyDescription(uti)		  #endif		End Function	#tag EndMethod	#tag Method, Flags = &h0		 Shared Function DeclaringBundleURL(uti as CFStringRef) As CFURL		  #if targetMacOS		    soft declare function UTTypeCopyDeclaringBundleURL lib CarbonFramework (uti as CFStringRef) as Ptr		    		    dim theURL as CFURL = UTTypeCopyDeclaringBundleURL(uti)		    if theURL <> nil then		      return theURL		    else		      return nil		    end if		  #endif		End Function	#tag EndMethod	#tag Method, Flags = &h0		 Shared Function OSType(uti as CFStringRef) As OSType		  #if targetMacOS		    soft declare function UTGetOSTypeFromString lib CarbonFramework (uti as CFStringRef) as OSType		    		    return UTGetOSTypeFromString(uti)		  #endif		End Function	#tag EndMethod	#tag Method, Flags = &h0		 Shared Function CreateFromOSType(tag as OSType, conformsTo as String = "") As String		  #if targetMacOS		    soft declare function UTCreateStringForOSType lib CarbonFramework (inOSType as OSType) as CFStringRef		    		    static tagClass as CFStringRef = ResolveTagClass("kUTTagClassOSType")		    		    return CreateUTI(UTCreateStringForOSType(tag), tagClass, conformsTo)		  #endif		End Function	#tag EndMethod	#tag Method, Flags = &h21		Private Shared Function CreateUTI(tag as CFStringRef, tagClass as CFStringRef, conformsTo as String = "") As String		  #if targetMacOS		    soft declare function UTTypeCreatePreferredIdentifierForTag lib CarbonFramework (inTagClass as CFStringRef, inTag as CFStringRef, inConformingToUTI as CFStringRef) as CFStringRef		    		    if conformsTo = "" then		      return UTTypeCreatePreferredIdentifierForTag(tagClass, tag, nil)		    else		      return UTTypeCreatePreferredIdentifierForTag(tagClass, tag, conformsTo)		    end if		  #endif		End Function	#tag EndMethod	#tag Method, Flags = &h21		Private Shared Function ResolveTagClass(symbol as String) As CFStringRef		  #if targetMacOS		    dim b as CFBundle = CFBundle.CarbonFramework		    if b is nil then		      return ""		    end if		    dim p as Ptr = b.DataPointer(symbol)		    if p = nil then		      return ""		    end if		    		    return p.CFStringRef(0)		  #endif		End Function	#tag EndMethod	#tag Method, Flags = &h0		 Shared Function CreateFromMIMEType(tag as String, conformsTo as String = "") As String		  #if targetMacOS		    static tagClass as CFStringRef = ResolveTagClass("kUTTagClassMIMEType")		    		    return CreateUTI(tag, tagClass, conformsTo)		  #endif		End Function	#tag EndMethod	#tag Method, Flags = &h0		 Shared Function CreateFromExtension(tag as String, conformsTo as String = "") As String		  #if targetMacOS		    static tagClass as CFStringRef = ResolveTagClass("kUTTagClassFilenameExtension")		    		    return CreateUTI(tag, tagClass, conformsTo)		  #endif		End Function	#tag EndMethod	#tag Method, Flags = &h0		 Shared Function CreateFromPasteboardType(tag as String, conformsTo as String = "") As String		  #if targetMacOS		    static tagClass as CFStringRef = ResolveTagClass("kUTTagClassNSPboardType")		    		    return CreateUTI(tag, tagClass, conformsTo)		  #endif		End Function	#tag EndMethod	#tag ViewBehavior		#tag ViewProperty			Name="Name"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Index"			Visible=true			Group="ID"			InitialValue="-2147483648"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Super"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Left"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Top"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty	#tag EndViewBehaviorEnd Class#tag EndClass