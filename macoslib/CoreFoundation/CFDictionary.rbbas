#tag ClassClass CFDictionaryInherits CFTypeImplements CFPropertyList	#tag Method, Flags = &h0		Function Value(key as CFType) As CFType		  if me.Equals(nil) then		    return nil		  end if		  		  if key is nil then		    return nil		  end if		  		  #if TargetCarbon		    soft declare function CFDictionaryGetValueIfPresent lib CarbonFramework (theDict as Ptr, key as Ptr, ByRef value as Ptr) as Boolean		    		    dim theValue as Ptr		    if CFDictionaryGetValueIfPresent(me, key, theValue) then		      return theValue		    else		      return nil		    end if		  #endif		End Function	#tag EndMethod	#tag Method, Flags = &h0		Function HasKey(key as CFType) As Boolean		  if me =nil then		    return false		  end if		  		  if key is nil then		    return false		  end if		  		  #if TargetCarbon		    soft declare function CFDictionaryContainsKey lib CarbonFramework (theDict as Ptr, key as Ptr) as Boolean		    		    return CFDictionaryContainsKey(me, key)		  #endif		End Function	#tag EndMethod	#tag Method, Flags = &h0		Function Keys() As CFType()		  if me.Equals(nil) then		    return nil		  end if		  		  #if TargetMacOS		    dim dictCount as Integer = me.Count		    if dictCount = 0 then		      dim emptyList() as CFType		      return emptyList		    end if		    		    soft declare sub CFDictionaryGetKeysAndValues lib CarbonFramework (theDict as Ptr, keys as Ptr, values as Ptr)		    		    const sizeOfCFTypeRef = 4		    dim keyList as new MemoryBlock(sizeOfCFTypeRef*dictCount)		    CFDictionaryGetKeysAndValues me, keyList, nil		    		    dim offset as Integer = 0		    dim theList() as CFType		    for i as Integer = 1 to dictCount		      theList.Append CFType.NewObject(keyList.Ptr(offset))		      offset = offset  + sizeOfCFTypeRef		    next		    		    return theList		  #endif		End Function	#tag EndMethod	#tag Method, Flags = &h0		Sub Constructor(theKeys() as CFType, theValues() as CFType)		  if UBound(theKeys) <> UBound(theValues) then		    return		  end if		  		  #if targetMacOS		    const defaultKeyCallBacks = "kCFTypeDictionaryKeyCallBacks"		    const defaultValueCallBacks = "kCFTypeDictionaryValueCallBacks"		    		    dim keyCallbacks as Ptr = me.DefaultCallbacks(defaultKeyCallBacks)		    dim valueCallbacks as Ptr = me.DefaultCallbacks(defaultValueCallBacks)		    		    soft declare function CFDictionaryCreate lib CarbonFramework (allocator as Ptr, keys as Ptr, values as Ptr, numValues as Integer, keyCallBacks as Ptr, valueCallBacks as Ptr) as Ptr		    		    if UBound(theKeys) > -1 then		      dim keyBlock as new MemoryBlock(4*(1 + UBound(theKeys)))		      dim valueBlock as new MemoryBlock(4*(1 + UBound(theValues)))		      dim offset as Integer = 0		      for i as Integer = 0 to UBound(theKeys)		        keyBlock.Ptr(offset) = theKeys(i)		        valueBlock.Ptr(offset) = theValues(i)		        offset = offset + 4		      next		      		      me.Operator_Convert CFDictionaryCreate(nil, keyBlock, valueBlock, 1 + UBound(theKeys), keyCallbacks, valueCallbacks)		      		    else		      me.Operator_Convert CFDictionaryCreate(nil, nil, nil, 0, keyCallbacks, valueCallbacks)		    end if		  #endif		  		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub Constructor(theDictionary as CFDictionary)		  if theDictionary Is nil then		    return		  end if		  		  #if TargetMacOS		    soft declare function CFDictionaryCreateCopy lib CarbonFramework (allocator as Ptr, theDict as Ptr) as Ptr		    		    me.Operator_Convert CFDictionaryCreateCopy(nil, me)		  #endif		End Sub	#tag EndMethod	#tag Method, Flags = &h21		Private Function DefaultCallbacks(name as String) As Ptr		  if name = "" then		    return nil		  end if		  		  dim CarbonFrameworkBundle as CFBundle = CFBundle.NewCFBundle(CarbonBundleID)		  if CarbonFrameworkBundle <> nil then		    return CarbonFrameworkBundle.DataPointer(name)		  else		    return nil		  end if		End Function	#tag EndMethod	#tag Method, Flags = &h0		 Shared Function ClassID() As UInt32		  soft declare function CFDictionaryGetTypeID lib CarbonFramework () as UInt32		  		  return CFDictionaryGetTypeID		End Function	#tag EndMethod	#tag Method, Flags = &h0		Function HasValue(value as CFType) As Boolean		  if me =nil then		    return false		  end if		  		  if value is nil then		    return false		  end if		  		  #if TargetCarbon		    soft declare function CFDictionaryContainsValue lib CarbonFramework (theDict as Ptr, value as Ptr) as Boolean		    		    return CFDictionaryContainsValue(me, value)		  #endif		End Function	#tag EndMethod	#tag ComputedProperty, Flags = &h0		#tag Getter			Get			if me.Equals(nil) then			return 0			end if						#if TargetCarbon			soft declare function CFDictionaryGetCount lib CarbonFramework (theDict as Ptr) as Integer						return CFDictionaryGetCount(me)			#endif			End Get		#tag EndGetter		Count As Integer	#tag EndComputedProperty	#tag Constant, Name = ClassName, Type = String, Dynamic = False, Default = \"CFDictionary", Scope = Private	#tag EndConstant	#tag ViewBehavior		#tag ViewProperty			Name="Name"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Index"			Visible=true			Group="ID"			InitialValue="-2147483648"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Super"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Left"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Top"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Count"			Group="Behavior"			InitialValue="0"			Type="Integer"		#tag EndViewProperty	#tag EndViewBehaviorEnd Class#tag EndClass